!function(e){function t(e,t){if(null!=t)for(var n in t)e[n]=t[n];return e}function n(e){var t=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(t),t.innerHTML=e}function o(e,t,n,o){let i="",a=Math.max(t||1,Math.round(Math.random()*e));n=null==n?65:n,o=null==o?26:o;for(let e=0;e<a;e++)i+=(String.fromCodePoint||String.fromCharCode)(Math.round(Math.random()*o)+n);return i}function i(e){return document.querySelectorAll(e)}var a=function(e){e.tile?l.apply(this,arguments):r.apply(this.arguments)},r=function(e){e=t({opacity:.005,fontSize:21,color:"yellow",rotate:-30},e),this.textClassName="wm-text-placeholder",this.addTextStyle=function(){n("."+this.textClassName+"{                    opacity:"+e.opacity+";                    -webkit-opacity:"+e.opacity+";                    -moz-opacity:"+e.opacity+";                    position:absolute;                    font-size:"+e.fontSize+"px;                    color:"+e.color+";                    display:inline;                    text-decoration:none;                    pointer-events:none;                    -webkit-user-select:none;                    -moz-user-select:none;                    -ms-user-select:none;                    user-select:none;                    transform:rotate("+e.rotate+"deg);                }            }")},this.attach=function(){this.addTextStyle();for(var t=i(e.selector),n=0;n<t.length;n++){var o=document.createElement("span");o.className=this.textClassName,o.style.filter="alpha(opacity="+100*e.opacity+")",o.innerHTML=e.content,t[n].appendChild(o)}}},l=function(e){let o=t({row:6,rowInterval:90,col:3,colInterval:180,x:0,y:0,unit:"px",containerClassName:"wm-container",containerStyle:!0},e);r.apply(this,arguments),this.containerClassName=o.containerClassName,this.addContainerStyle=function(){let e="";"boolean"==typeof o.containerStyle?!0===o.containerStyle&&(e="."+this.containerClassName+"{                        position:absolute;                        top:0;                        left:0;                        z-index:-1;                    }"):o.containerStyle&&"string"==typeof o.containerStyle&&(e=o.containerStyle),e&&n(e)},this.createContainer=function(){var e=document.createElement("div");e.className=this.containerClassName;for(var t=0;t<o.row;t++)for(var n=0;n<o.col;n++){var i=document.createElement("span");i.className=this.textClassName,i.style.marginTop=t*o.rowInterval+o.y+o.unit,i.style.marginLeft=n*o.colInterval+o.x+o.unit,i.innerHTML=o.content,e.appendChild(i)}return e};var a=null;o.renew&&(a=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&e.removedNodes&&e.removedNodes.forEach(function(t){t.classList.contains(o.containerClassName)&&e.target.appendChild(t)})})})),this.attach=function(){this.addContainerStyle(),this.addTextStyle();for(var t=i(e.selector),n=0;n<t.length;n++)t[n].appendChild(this.createContainer()),o.renew&&a&&1!=t[n].htmlObserved&&(a.observe(t[n],{childList:!0}),t[n].htmlObserved=!0)}},s=function(e){if((e=t({color:"yellow",opacity:.005,fontSize:21,rotate:-30,suffix:"::before"},e)).originSelector=e.selector,e.selector.indexOf(":")<0){for(var o=e.selector.split(","),i=0;i<o.length;i++)o[i].indexOf(":")<0&&(o[i]=o[i].replace(/(\s+$)|(^\s+)/gi,"")+e.suffix);e.selector=o.join(",")}this.attach=function(){n("@media screen{                "+e.selector+'{                    content:"'+(e.content||"")+'";                    opacity:'+e.opacity+";                    -webkit-opacity:"+e.opacity+";                    -moz-opacity:"+e.opacity+";                    position:absolute;                    font-size:"+e.fontSize+"px;                    color:"+e.color+";                    display:inline;                    text-decoration:none;                    pointer-events:none;                    -webkit-user-select:none;                    -moz-user-select:none;                    -ms-user-select:none;                    user-select:none;                    transform:rotate("+e.rotate+"deg);                }            }")}},c=function(e){let n=t({color:"#eee",rotate:-30,fontSize:21,width:null,height:null},e);var o=null;function a(t){let i=n.content;if("function"==typeof n.content&&!(i=n.content()))return setTimeout(()=>{a(t)},10);setTimeout(()=>{let a=function(e){let t=document.createElement("canvas");t.width=n.width||n.fontSize*e.length*.7,t.height=n.height||n.fontSize*e.length*.4;let o=t.getContext("2d");return o.translate(n.fontSize/3,t.height-n.fontSize/3),o.rotate(n.rotate*Math.PI/180),o.font=n.fontSize+"px Arial",o.fillStyle=n.color,o.fillText(e,0,0),t.toDataURL("png")}(i);e.tile?t.style.background=`repeat url(${a})`:t.style.background=`url(${a})`,t.cssStyleBackground=t.style.background,n.renew&&o&&1!=t.cssObserved&&(o.observe(t,{attributes:!0,attributeFilter:["style"]}),t.cssObserved=!0)},0)}n.renew&&(o=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&"style"==e.attributeName&&e.target.cssStyleBackground!=e.target.style.background&&(e.target.style.background=e.target.cssStyleBackground)})})),this.attach=function(){var e=i(n.selector);for(let t=0;t<e.length;t++)a(e[t])}},d=function(e){let n=t({targetNodeType:Node.TEXT_NODE,tag:"i",tagWidth:"1px",containerTag:"span",userSelect:"none",headerWidth:2,totalWidth:20,noise:!1,noiseAll:!1,noiseColor:"transparent",skipChars:["，","。","：","；","“","”","。","《","》","（","）","——","【","】"],fnIsSkipChars:function(e){return!!e&&(n.skipChars&&n.skipChars.indexOf(e)>-1||e.charCodeAt(0)<256)}},e);function a(e,t){var i=e.childNodes;i.length&&i.forEach(function(e){e.nodeType===n.targetNodeType?function(e,t){if(e){let i=null;i=e.nodeType==Node.TEXT_NODE?e.wholeText:e.innerText?e.innerText:e.textContent;let a=null;if(1==n.noise?a=function(){return o(6,null,19968,3e3)}:"function"==typeof n.noise&&(a=n.noise),null!==i&&i.length>t.length){let o="",r=!1;for(let e=0,l=0;e<i.length;e++)if(o+=i[e],!1===n.fnIsSkipChars(i[e])){let e="1"==t[l%t.length]?n.tagWidth:"0px",i=a&&n.noiseAll||"0px"!==e;l++,i&&(r=!0,o+=a?`<${n.tag} style='display:inline-block;width:${e};color:${n.noiseColor};white-space:nowrap;wordbreak:keep-all'>${a(n)}</${n.tag}>`:`<${n.tag} style='display:inline-block;width:${e};'></${n.tag}>`)}if(r){let t=document.createElement(n.containerTag);t.innerHTML=o,t.style.userSelect=n.userSelect,e.replaceWith(t)}}}}(e,t):a(e,t)})}function r(e,t,n){if(isNaN(+t))throw"请先转换为字值";let o=t.toString(2);o=o.length<n.totalWidth?o.padStart(n.totalWidth,"0"):o.substring(o.length-n.totalWidth),n.headerWidth>0&&(o=new Array(n.headerWidth+1).join("0")+o),a(e,o)}this.attach=function(){var e=i(n.selector);for(let t=0;t<e.length;t++)e[t].style.userSelect=n.userSelect,r(e[t],n.content,n)}};var u={create:function(e){var n={selector:"p, td",mode:null,tile:!0,content:"",color:"yellow",opacity:.005,fontSize:21,rotate:-30,renew:!0};return"string"==typeof e?n.content=e:t(n,e),("css"==n.mode?new s(n):"bg"==n.mode?new c(n):"txt"==n.mode?new d(n):"html"==n.mode?new a(n):new s(n)).attach()},distroy:function(){},randomChars:o};"function"==typeof define&&define.amd?define(u):"object"==typeof exports&&(module.exports=w),e.wm=u}(window);